$(document).ready(function(){MealsReview.initView()});var MealsReview=function(){function a(){b(),c()}function b(){d(1)}function c(){$("input[id^=delete-]").off().on("click",function(a){a.preventDefault(),$(".popup-wrapper").hide(),$(".confirm-popup-wrapper .header").text("Delete"),$(".confirm-popup-wrapper .content span").text("Are you sure you want to delete?"),$("#yes-button").attr("data-id",this.id.substring(7)),$(".confirm-popup-wrapper").show()}),$("#yes-button").off().on("click",function(a){a.preventDefault(),$(".confirm-popup-wrapper").hide(),f($(this).attr("data-id"))}),$("#no-button").off().on("click",function(a){a.preventDefault(),$(".confirm-popup-wrapper").hide()})}function d(a){var b=baseURL+"cms/get_all_ratings/",c={"session-key":localStorage.session_key},d={nextPage:a};data=JSON.stringify(d);var e=new AjaxHttpSender;e.sendPost(b,c,data,MealsReview.loadReviewsCallback)}function e(a){var b="",e=a.aaData;$.each(e,function(a,c){b+="<tr><td>"+c.meal_name+"</td><td>"+c.user.name+'</td><td><span style="margin: 0px -20px;">';for(var d=1;5>=d;d++)b+=c.rating>=d?'<input type="radio" class="rating-input" id="rating-input-'+d+"-"+a+'" name="rating-input-'+d+"-"+a+'"><label for="rating-input-'+d+"-"+a+'" class="rating-star disable-star change-color"></label>':' <input type="radio" class="rating-input" id="rating-input-'+d+"-"+a+'" name="rating-input-'+d+"-"+a+'"><label for="rating-input-'+d+"-"+a+'" class="rating-star disable-star"></label>';b+="</span></td><td>"+c.comment+'</td><td><input type="button" id="delete-'+c.id+'" class="btn btn-small-primary medium-green" value="DELETE"></td></tr>'}),$("#reviewsArea tbody").html(b),$(".pagination").pagination({pages:a.num_pages,currentPage:a.current_page,cssStyle:"light-theme",onPageClick:function(a,b){d(a)},onInit:function(){if(getStringAfterHash(location.href,"#")){var a=getStringAfterHash(location.href,"#");-1!=a.indexOf("page")&&(pageNumber=getStringAfterHash(a,"-"),$(".pagination").pagination("getCurrentPage")==pageNumber||$(".pagination").pagination("selectPage",pageNumber))}}}),c()}function f(a){var b=baseURL+"cms/delete_meal_rating/"+a+"/",c={"session-key":localStorage.session_key},d={};data=JSON.stringify(d);var e=new AjaxHttpSender;e.sendPost(b,c,data,MealsReview.deleteAPICallback)}var g={success:function(a,b){var c=JSON.parse(a);-1==c.status?showPopup(c):e(c)},failure:function(a,b,c){}},h={success:function(a,b){var c=JSON.parse(a);-1==c.status?showPopup(c):d($(".pagination").pagination("getCurrentPage"))},failure:function(a,b,c){}};return{initView:a,loadReviewsCallback:g,deleteAPICallback:h}}();