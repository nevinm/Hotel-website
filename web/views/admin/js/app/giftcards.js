function listGiftCards(a,b,c){var d=baseURL+"cms/list_gift_cards/";header={"session-key":localStorage.session_key},params={nextPage:a,name:b,code:c},data=JSON.stringify(params);var e=new AjaxHttpSender;e.sendPost(d,header,data,listGiftCardsCallback)}function populateGiftCardsList(a){$("#giftcards-list tbody").empty(),0==a.aaData.length?$("#giftcard-list-empty").show():($.each(a.aaData,function(a,b){$("#giftcards-list tbody").append("<tr data-id='"+b.id+"'><td class='card-code'>"+b.code+"</td><td class='card-name'>"+b.name+"</td><td class='card-amount' data-amount='"+b.amount+"'>"+dollarConvert(b.amount)+"</td><td class='no-popup'><button type='button' class='giftcard-edit btn btn-small-primary medium-green' data-id='"+b.id+"'>Edit</button></td><td class='no-popup'><button type='button' class='giftcard-delete btn btn-small-primary medium-green' data-id='"+b.id+"'>Delete</button></td></tr>"),currentStatus=b.status_id,$(".order-status:last").val(currentStatus)}),$(".pagination").pagination({pages:a.num_pages,currentPage:a.current_page,cssStyle:"light-theme",onPageClick:function(a,b){listGiftCards(a)},onInit:function(){if(getStringAfterHash(location.href,"#")){var a=getStringAfterHash(location.href,"#");-1!=a.indexOf("page")&&(pageNumber=getStringAfterHash(a,"-"),$(".pagination").pagination("getCurrentPage")==pageNumber||$(".pagination").pagination("selectPage",pageNumber))}}})),$(".popup-wrapper").hide()}function manageGiftcards(a){var b=baseURL+"cms/manage_gift_card/",c={"session-key":localStorage.session_key},d={edit_id:a.editId,delete_id:a.deleteId,code:a.code,name:a.name,amount:a.amount};$.each(d,function(a,b){giftcardEmptyCheck(a,b)}),data=JSON.stringify(giftcardParams);var e=new AjaxHttpSender;e.sendPost(b,c,data,manageGiftcardsCallback)}function giftcardEmptyCheck(a,b){b&&(giftcardParams[a]=b)}$(document).ready(function(){listGiftCards(0),giftcardParams={},$(document).on("click",".giftcard-delete",function(){giftcardParams={},cardId=$(this).data().id,confirm("Are you sure you want to delete this giftcard?")&&(giftcardParams.deleteId=cardId,manageGiftcards(giftcardParams))}),$(document).on("click",".giftcard-edit",function(){giftcardParams={},$this=$(this);var a=$this.parents().eq(1).find(".card-code").text(),b=$this.parents().eq(1).find(".card-name").text(),c=$this.parents().eq(1).find(".card-amount").data("amount");$("#new-code").val(a),$("#new-name").val(b),$("#new-amount").val(c),$("#update").data("id",$this.data("id")),$("#update").val("update"),$(".popup-wrapper").show(),$("form.edit-gift-card").validate().resetForm()}),$("#update").on("click",function(a){if(a.preventDefault(),"add"==$("#update").val()){var b=$("#new-code").val(),c=$("#new-name").val(),d=$("#new-amount").val();giftcardaddDetails={code:b,name:c,amount:d},$("form").valid()&&manageGiftcards(giftcardaddDetails)}else{var b=$("#new-code").val(),c=$("#new-name").val(),d=$("#new-amount").val(),e=$(this).data("id");giftcardDetails={editId:e,code:b,name:c,amount:d},$("form").valid()&&manageGiftcards(giftcardDetails)}}),$(document).on("click","#add-gift-card",function(){$("#update").val("add"),$("form.edit-gift-card")[0].reset(),$(".popup-wrapper").show(),$("form.edit-gift-card").validate().resetForm()}),$("#search-coupon-code").on("click",function(){var a=$("#gift-card-name").val(),b=$("#coupon-code").val();listGiftCards("",a,b)})});var listGiftCardsCallback={success:function(a,b){var c=JSON.parse(a);1==c.status?populateGiftCardsList(c):showErrorPopup(c)},failure:function(a,b,c){}},manageGiftcardsCallback={success:function(a,b){var c=JSON.parse(a);1==c.status?(currentPage=$(".pagination").pagination("getCurrentPage"),listGiftCards(currentPage)):showErrorPopup(c),$(".popup-wrapper").hide()},failure:function(a,b,c){}};