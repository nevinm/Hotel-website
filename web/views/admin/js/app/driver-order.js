function updateOrders(a,b,c){var d=baseURL+"cms/update_order/"+a+"/",e={"session-key":localStorage.session_key},f={status:b};data=JSON.stringify(f);var g=new AjaxHttpSender;g.sendPost(d,e,data,updateOrdersCallback,c)}function getDeliveryOrders(a,b,c,d,e,f,g,h){var i=baseURL+"cms/get_delivery_orders/",j={"session-key":localStorage.session_key},k={nextPage:a,search:b,num:c,status:d};data=JSON.stringify(k);var l=new AjaxHttpSender;l.sendPost(i,j,data,getDeliveryOrdersCallback)}function populateDeliveryOrderList(a){$("table#delivery-order tbody").empty(),$.each(a.aaData,function(a,b){var c=undefinedCheck(b.phone),d=undefinedCheck(b.user_first_name+" "+b.user_last_name),e=undefinedCheck(b.delivery_time),f=undefinedCheck(b.delivery_address.zip),g=(undefinedCheck(b.email),undefinedCheck(b.grand_total),{}),g=undefinedCheck(b.delivery_address),h=undefinedCheck(b.delivery_type),i=(undefinedCheck(g.first_name)+" "+undefinedCheck(g.last_name),undefinedCheck(g.building)),j=undefinedCheck(g.company),k=undefinedCheck(g.street),l=undefinedCheck(g.city),m=undefinedCheck(g.state),n=(undefinedCheck(g.phone),undefinedCheck(g.zip),undefinedCheck(b.meals)),o=convertToMeridianTime(e);null===!b.driver_instructions&&b.driver_instructions.length?instructions=b.driver_instructions:instructions="None",$("table#delivery-order tbody").append("<tr data-id='"+b.id+"'><td class='driver-time'>"+o.date+"<br>"+o.time+"</td><td>"+b.order_num+"</td><td>"+f+"</td><td><span class='address'>"+(j.length>0?j+", ":"")+(i.length>0?i+", ":"")+", "+k+"</span></td><td><span class='address'>"+l+", "+m+"</span></td><td>"+d+"</td><td>"+c+"</td><td class='meals'></td><td class='qty'></td><td>"+h+"</td><td>"+instructions+"</td><td><select data-id='"+b.id+"'class='order-status' name='status'><option value='0'>Placed</option><option value='1'>Packed</option><option value='2'>Dispatched</option><option value='3'>Delivered</option><option value='4'>Cancelled</option></select></td>NaN"),"pickup"==h&&(addressElements=$(".address").slice(-2),$.each(addressElements,function(a,b){$(b).text("NONE")})),mealLength=n.length,$.each(n,function(a,b){$("#delivery-order td.qty:last").append("<span>"+b.quantity+" </span>"),a+1==mealLength?$("#delivery-order td.meals:last").append("<span>"+b.name+" </span>"):$("#delivery-order td.meals:last").append("<span>"+b.name+",</span>")}),currentStatus=b.status_id,$(".order-status:last").val(currentStatus)}),$(".pagination").pagination({items:a.total_count,itemsOnPage:a.per_page,currentPage:a.current_page,cssStyle:"light-theme",onPageClick:function(a,b){getDeliveryOrders(a)},onInit:function(){if(getStringAfterHash(location.href,"#")){var a=getStringAfterHash(location.href,"#");-1!=a.indexOf("page")&&(pageNumber=getStringAfterHash(a,"-"),$(".pagination").pagination("getCurrentPage")==pageNumber||$(".pagination").pagination("selectPage",pageNumber))}}}),$(".order-status").on("change",function(){var a=$(this).data("id"),b=$(this).val();updateOrders(a,b,this)})}function undefinedCheck(a){return"undefined"==typeof a?"NONE":a}$(document).ready(function(){getDeliveryOrders(0),setInterval(function(){getDeliveryOrders()},6e4)});var updateOrdersCallback={success:function(a,b,c){updatedOrders=JSON.parse(a),updatedOrders.status||showPopup(a)},failure:function(a,b,c){}},getDeliveryOrdersCallback={success:function(a,b){var c=JSON.parse(a);1==c.status&&(c.aaData.length>0?populateDeliveryOrderList(c):$(".pagination").pagination({pages:0,cssStyle:"light-theme"}))},failure:function(a,b,c){}};