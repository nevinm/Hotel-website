function showCallBackStatusPre(){$(".popup-input-wrapper").hide(),$("#add-mealtype, #edit-mealtype").hide(),$(".callback-status").show(),$(".header").text("MESSAGE"),$("#close").addClass("clear")}function showMealTypeManagePre(){$("#close").removeClass("clear"),$(".popup-input-wrapper").show(),$(".callback-status").hide()}function addDynamicApiUrlUploadPicture(a){$("."+a).attr("data-url",baseURL+"cms/upload_image/")}function uploadImage(a,b){$(a).fileupload({add:function(a,b){var c=/^image\/(gif|jpe?g|png)$/i,d=[];return b.originalFiles[0].type&&!c.test(b.originalFiles[0].type)?(d.message="Not an accepted file type",showCallBackStatusPre(),void showPopup(d)):b.originalFiles[0].size&&b.originalFiles[0].size>2e6?(d.message="Filesize is too big",showCallBackStatusPre(),void showPopup(d)):void b.submit()},dataType:"json",headers:{"session-key":localStorage.session_key},formData:{example:"test"},start:function(a){$(".upload-gif").show()},done:function(a,c){$(".upload-gif").hide(),1==c.result.status?($(b).attr("src",c.result.thumbnail_url),$(b).attr("data-id",c.result.id),$(b).show()):(showCallBackStatusPre(),showPopup(c.result))}})}function getMealtypes(a,b){var c=baseURL+"cms/list_attributes/";header={"session-key":localStorage.session_key},params={nextPage:a},data=JSON.stringify(params);var d=new AjaxHttpSender;d.sendPost(c,header,data,getMealtypesCallback)}function populateMealtypes(a){$("#mealtype-area tbody tr").remove(),$.each(a.aaData,function(a,b){$("#mealtype-area tbody").append("<tr class='row' data-id='"+b.id+"'><td class='mealtype-name-value'>"+b.name+"</td><td><input type='button' data-url='"+b.image+"' class='btn btn-small-primary medium-green' id='edit-mealtype-name' data-imageid='"+b.image_id+"' value='EDIT'></td><td><input type='button' class='btn btn-small-primary medium-green' id='delete-mealtype' value='DELETE'></td><td><img class='mealtype-icon' src='"+b.image+"'/><input class='mealtype-image-upload-element' value='' type='file' name='image_upload'/></td></tr>")}),$(".mealtype-image-upload").on("click",function(){$(this).parent().find(".mealtype-image-upload-element").click()}),$(".mealtype-image-upload-element").on("click",function(){var a=$(this),b=$(this).parent().find(".mealtype-icon");uploadImage(a,b)}),addDynamicApiUrlUploadPicture("mealtype-image-upload-element")}function manageMealtype(a,b,c){var d=baseURL+"cms/create_attribute/";header={"session-key":localStorage.session_key},params={attribute_name:b,attribute_image:c},a&&(params.attribute_id=a),data=JSON.stringify(params);var e=new AjaxHttpSender;e.sendPost(d,header,data,manageMealtypeCallback)}function deleteMealtype(a){var b=baseURL+"cms/delete_attribute/"+a+"/";header={"session-key":localStorage.session_key},params={},data=JSON.stringify(params);var c=new AjaxHttpSender;c.sendPost(b,header,data,deleteMealtypeCallback)}function showPopupMessage(a){$(".popup-message span").text(a.message),$(".popup-message").show(),setTimeout(function(){$(".popup-message").hide()},2e3)}function deleteZip(a){$("tr[data-id='"+a+"']").remove()}function setMealTypeImageLoader(){""===$(".mealtype-image").attr("src")?$(".mealtype-image").hide():$(".mealtype-image").show()}var current_tr;$(document).ready(function(){$("#add-new-mealtype").on("click",function(){showMealTypeManagePre(),$(".mealtype-image").attr("src",""),$("#new-mealtype").val(""),$("#add-mealtype").show(),$(".mealtype-image").data().id="",$("#edit-mealtype").hide(),$(".header").text("ADD NEW MEAL TYPE"),$(".popup-wrapper").show(),$("#new-mealtype").hasClass("error")&&$("form.popup-container").valid(),$("form").data("validator").resetForm(),setMealTypeImageLoader()}),$("#add-mealtype").on("click",function(a){if(a.preventDefault(),$(".popup-container").valid()){$(".popup-wrapper").hide();var b=$("#new-mealtype").val(),c=$(".mealtype-image").attr("data-id");manageMealtype("",b,c)}}),$(document).on("click","#delete-mealtype",function(){$(".popup-wrapper").hide(),$(".confirm-popup-wrapper .header").text("Delete"),$(".confirm-popup-wrapper .content span").text("Are you sure you want to delete?");var a=$(this).closest("tr").attr("data-id");$("#yes-button").attr("data-id",a),$(".confirm-popup-wrapper").show()}),$("#yes-button").on("click",function(){var a=$(this).attr("data-id");$(".confirm-popup-wrapper").hide(),deleteMealtype(a)}),$("#no-button").on("click",function(){$(".confirm-popup-wrapper").hide()}),$(document).on("click","#edit-mealtype-name",function(){var a=$(this).closest("tr").find(".mealtype-name-value").text(),b=$(this).data("url"),c=$(this).data("imageid");showMealTypeManagePre(),$("#add-mealtype").hide(),$("#edit-mealtype").show(),$(".header").text("EDIT MEAL TYPE"),$("#new-mealtype").val(a),$(".mealtype-image").attr("data-id",c),$(".popup-wrapper").show(),$("#new-mealtype").hasClass("error")&&$("form.popup-container").valid(),$(".mealtype-image").attr("src",b),current_tr=$(this).closest("tr"),setMealTypeImageLoader()}),$("#edit-mealtype").on("click",function(a){if(a.preventDefault(),$(".popup-container").valid()){$(".popup-wrapper").hide();var b=current_tr.attr("data-id"),c=$("#new-mealtype").val(),d=$(".mealtype-image").attr("data-id");manageMealtype(b,c,d)}}),$(".mealtype-change-icon").on("click",function(){$(this).next(".mealtype-image-upload-element").trigger("click")}),getMealtypes(1)});var getMealtypesCallback={success:function(a,b){var c=JSON.parse(a);1==c.status?populateMealtypes(c):(showCallBackStatusPre(),showPopup(c))},failure:function(a,b,c){}},manageMealtypeCallback={success:function(a,b){var c=JSON.parse(a);-1==c.status?(showCallBackStatusPre(),showPopup(c)):getMealtypes(1)},failure:function(a,b,c){}},deleteMealtypeCallback={success:function(a,b){var c=JSON.parse(a);-1==c.status?(showCallBackStatusPre(),showPopup(c)):getMealtypes(1)},failure:function(a,b,c){}};