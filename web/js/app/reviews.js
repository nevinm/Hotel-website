function getReviews(a){var b=baseURL+"get_user_reviews/",c={"session-key":localStorage.session_key},d={order_id:a};data=JSON.stringify(d);var e=new AjaxHttpSender;e.sendPost(b,c,data,getReviewsCallback)}function addReviews(a,b,c,d){var e=baseURL+"add_rating/"+d+"/",f={"session-key":localStorage.session_key},g={order_id:c,rating:b,comment:a};data=JSON.stringify(g);var h=new AjaxHttpSender;h.sendPost(e,f,data,addReviewsCallback)}function populateReviews(a){a.reviews.length?$(a.reviews).each(function(a,b){$(".meal-review-container").append("<div class='meal-reviews meal-reviews-row'><div class='details meal-review-cell'><img class='meal-image' src='"+b.meal_image+"'><span class='meal-name'>"+b.meal_name+"</span></div><div class='rating meal-review-cell'><span class='meal-star-rating'><input type='radio' class='rating-input' id='rating-input-1-5' name='rating-input-1' data-id='5'><label for='rating-input-1-5' class='rating-star'></label><input type='radio' class='rating-input' id='rating-input-1-4' name='rating-input-1' data-id='4'><label for='rating-input-1-4' class='rating-star'></label><input type='radio' class='rating-input' id='rating-input-1-3' name='rating-input-1' data-id='3'><label for='rating-input-1-3' class='rating-star'></label><input type='radio' class='rating-input' id='rating-input-1-2' name='rating-input-1' data-id='2'><label for='rating-input-1-2' class='rating-star'></label><input type='radio' class='rating-input' id='rating-input-1-1' name='rating-input-1' data-id='1'><label for='rating-input-1-1' class='rating-star'></label></span></div><div class='meal-review-textarea meal-review-cell'><textarea maxlength='250' class='user-reviews' placeholder='Leave a review (Optional) '>"+b.review+"</textarea></div><div class='meal-review-submit meal-review-cell'><a href='#' class='btn btn-medium-primary medium-green add-review' id='add-review' data-meal-id='"+b.meal_id+"'data-order-id='"+b.order_id+"' >Submit</a></div></div>");var c=$(".meal-review-container").find(".meal-reviews:last"),d=$($(c).find(".rating-star").get().reverse())[b.rating-1];b.review.length&&($(".user-reviews:last").attr("disabled",!0),$(".meal-star-rating:last").find(".rating-star").addClass("disable-star")),$(d).trigger("click")}):$(".message").show()}function changeSessionKey(){var a,b,c=window.location.href;-1!=c.indexOf("sess")&&-1!=c.indexOf("order_id")?(a=getParameterFromUrl("sess"),localStorage.session_key=a,b=getParameterFromUrl("order_id"),getReviews(order_id)):getReviews(),CartItemCount()}$(document).ready(function(){$(document).on("click",".rating-star",function(){var a=$(this).prev().attr("data-id"),b=$(this).parent().find(".rating-star");$(b).removeClass("change-color"),$($(b).get().reverse().slice(0,a)).each(function(a,b){$(b).addClass("change-color")}),$(this).parent().attr("data-rating",a)}),$(document).on("click",".add-review",function(){var a=$(this).parents().eq(1),b=$(a).find(".user-reviews").val(),c=$(a).find(".meal-star-rating").data("rating"),d=$(this).data("orderId");mealId=$(this).data("mealId"),addReviews(b,c,d,mealId)}),changeSessionKey()});var getReviewsCallback={success:function(a,b){var c=JSON.parse(a);1==c.status&&populateReviews(c)},failure:function(a,b,c){}},addReviewsCallback={success:function(a,b){var c=JSON.parse(a);showPopup(c),1==c.status},failure:function(a,b,c){}};